\documentclass[xcolor={usenames,dvipsnames}]{beamer}

\usepackage[T1]{fontenc}
\usepackage{totcount}
\regtotcounter{section}
\usepackage{multido}
\usepackage{verbatim}
\usepackage{listings}

\title{Introduction to Dependent Types}
\subtitle{Eagan Technology Unconference}
\author{Joseph Ching}
\date{September 22, 2015}

\usetheme{Antibes}
\usecolortheme{beaver}

\newcommand{\mytableofcontents}[0]{
  \multido{\I=1+1}{\totvalue{section}}{
    \begin{frame}<beamer>
      \setcounter{section}{\I}
      \frametitle{Outline}
      \tableofcontents[
      currentsection,
      sectionstyle=show/show,
      subsectionstyle=show/show/hide,
      ]
    \end{frame}
  }
  \setcounter{section}{0}
}
\newcommand{\hkeyword}[1]{\textcolor{TealBlue}{\textsc{#1}}}
\newcommand{\hfunction}[1]{\textcolor{Green}{\textsc{#1}}}
\newcommand{\htycon}[1]{\textcolor{Blue}{\textsc{#1}}}
\newcommand{\hvalcon}[1]{\textcolor{Red}{\textsc{#1}}}
\newcommand{\hkind}[1]{\textcolor{Fuchsia}{\textsc{#1}}}
\newcommand{\hclass}[1]{\textcolor{Magenta}{\textsc{#1}}}
\newcommand{\htyfam}[1]{\textcolor{OliveGreen}{\textsc{#1}}}
\newcommand{\hcomment}[1]{\textcolor{Grey}{\textsc{#1}}}
\newcommand{\hother}[1]{\textcolor{Black}{\textsc{#1}}}

\lstdefinestyle{hask}{
  basicstyle=\ttfamily\scriptsize\color{Black},
  sensitive=true,
  morecomment=[l][\color{Gray}\ttfamily\tiny]{--},
  morecomment=[s][\color{Gray}\ttfamily\tiny]{\{-}{-\}},
  morestring=[b]",
  stringstyle=\color{Maroon},
  showstringspaces=false,
  numberstyle=\color{Red},
  numberblanklines=true,
  showspaces=false,
  breaklines=true,
  showtabs=false,
  moredelim=**[is][\color{TealBlue}]{@kw}{@},
  moredelim=**[is][\color{Green}]{@f}{@},
  moredelim=**[is][\color{Blue}]{@tc}{@},
  moredelim=**[is][\color{Red}]{@vc}{@},
  moredelim=**[is][\color{Fuchsia}]{@dk}{@},
  moredelim=**[is][\color{Magenta}]{@cc}{@},
  moredelim=**[is][\color{OliveGreen}]{@tf}{@},
  moredelim=**[is][\color{Maroon}]{@str}{@},
  escapeinside={{@|}{@}},
  % Keywords
  emph=
  {[1]
    module,import,qualified,hiding,as,foreign,infix,infixr,infixl,
    where,let,in,case,of,if,then,else,do,rec,proc,forall,pi,
    type,newtype,data,family,class,instance,deriving,default
  },
  emphstyle={[1]\color{TealBlue}\textbf},
  % functions
  emph=
  {[2]
    map,filter,foldr,length,fmap,id
  },
  emphstyle={[2]\color{Green}},
  % type constructors
  emph=
  {[3]
    Char,String,Bool,Int,Integer,Double,Float,Ordering,Maybe,Either,IO
  },
  emphstyle={[3]\color{Blue}\textbf},
  emph=
  % value constructors
  {[4]
    True,False,Nothing,Just,Left,Right,GT,LT,EQ
  },
  emphstyle={[4]\color{Red}\textbf},
  % type classes, contexts, constraints
  emph=
  {[5]
    Show,Read,Eq,Ord,Enum,Bounded,Num,
    Monoid,Functor,Foldable,Traversable,Applicative,Alternative,Monad,Comonad,Arrow
  },
  emphstyle={[5]\color{Magenta}\textbf},
  % kinds
  emph=
  {[6]
    Constraint,AnyK,OpenKind,BOX
  },
  emphstyle={[6]\color{Fuchsia}\textbf},
  % type families
  emph=
  {[7]
    Plus,Mult
  },
  emphstyle={[7]\color{OliveGreen}\textbf},
  % foreign languages
  emph=
  {[8]
    enum, interface
  },
  emphstyle={[8]\color{TealBlue}\textbf},
}

\begin{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Title Page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[plain]
  \titlepage
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Table of Content
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Want to hide subsection slide by slide
%\begin{frame}{Table of Contents}
%  \tableofcontents[pausesections]
%\end{frame}
\mytableofcontents


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Preface
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preface}

\begin{frame}{Quick Question}
  How many are familiar with this topic?
\end{frame}

\begin{frame}{A Joke}
  This is not a \texttt{m-} tutorial.

  \pause

  Nor is it a \texttt{lens} tutorial
  \pause
  (aka the new new \texttt{m-} tutorial\ldots

  \pause
  \ldots because \texttt{arrows} \textit{were} the new \texttt{m-} tutorials).

\end{frame}


\begin{frame}{About This Talk}
    \texttt{Agda}, \texttt{Idris}, \texttt{Coq} and co$^*$ have full support for dependent types.

    \ \\
    \pause
    Because of that, it's harder to see the build up, so we won't be directly using them in this talk.
    \ \\
    \ \\
    \pause
    \textit{\tiny{Honestly though, it's because they're way over my head :(}}\\
    \textit{\tiny{(*) There was another mini joke here\ldots}}
\end{frame}

\begin{frame}{About This Talk}
  But we will be using \texttt{Haskell} though :)

  \ \\
  \pause
  It's not truely dependent, but we can do more and more with each \texttt{language extension} that comes along.\\

  \ \\
  \pause
  For the examples, there will also be \textit{very} loose translation to imperative/OOP. Though please keep in mind that these are merely syntax translations, the actual concepts can differ vastly.
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Introduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Review of Basics}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Test}
% Test highlighting examples
\begin{frame}[fragile]{Test}
  Syntax highlighting test reference, to be removed later.

  \begin{lstlisting}[style=hask]
      -- Comment
      data Maybe a = Nothing | Just a
                     deriving (Show, Eq)
 
      fmap :: Functor f => (a -> b) -> f a -> f b
      map _ @vc[]@     = @vc[]@
      map f (x@vc:@xs) = f x @vc:@ map f xs
 
      type family @tfTF@ a :: @dk*@
      type instance @tfTF@ Int = Bool
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Test}
  Couldn't quite yet get listing to work with overlay yet.

  \begin{lstlisting}[style=hask]
      {- block comment -}
      @ffoo@ :: Bool -> Int -> String
      @ffoo@ False @vc0@ = "Bad"
      @ffoo@ True  @vc0@ = "Questionable"
      @ffoo@ False n = "Fake"
      @ffoo@ True  n = "Read"
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Test}
  Pausing within listing is ok?

  \begin{lstlisting}[style=hask]
    {-# LANGUAGE KitchenSink #-}
    @fzipWith@ :: (a -> b -> c) -> @vc[@a@vc]@ -> @vc[@b@vc]@ -> @vc[@c@vc]@ @|\pause@
    @fzipWith@ _ @vc[]@     _      = @vc[]@ @|\pause@
    @fzipWith@ _ _      @vc[]@     = @vc[]@ @|\pause@
    @fzipWith@ f (x@vc:@xs) (y@vc:@ys) = f x y @vc:@ @fzipWith@ f xs ys
  \end{lstlisting}

  better yet

  \begin{lstlisting}[style=hask]
    {-# LANGUAGE KitchenSink #-}
    @fzipWith@ :: (a -> b -> c) -> @vc[@a@vc]@ -> @vc[@b@vc]@ -> @vc[@c@vc]@
    @fzipWith@ f (x@vc:@xs) (y@vc:@ys) = f x y @vc:@ @fzipWith@ f xs ys
    @fzipWith@ _ _      _      = @vc[]@
  \end{lstlisting}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Values and Types}

\begin{frame}[fragile]{Values and Types}
  \hvalcon{Values} has \htycon{Types}, or \hvalcon{Values} are classified by \htycon{Types}.\\

  \begin{lstlisting}[style=hask]
    @|\ldots@, @vc-1@, @vc0@, @vc1@, @vc2@, @vc3@, @|\dots@ :: Int @|\pause@
    True, False :: Bool @|\pause@
    @str'a'@, @str'b'@, @str'c'@ :: Char @|\pause@
    "abc" :: String @|$\sim$@ @tc[@Char@tc]@

  \end{lstlisting}

  \tiny{\hvalcon{Values} are also called \hvalcon{Terms}}
\end{frame}

\begin{frame}[fragile]{About Types}
  How are data types defined?\\
  \pause
  \begin{itemize}
    \item Some are built in magic: \htycon{Int}, \htycon{Char}, functions
    \pause
    \item Some are built in sugar: list, tuples
      \begin{itemize}
        \item We can define equivalent non-sugar-ed version ourselves
      \end{itemize}
    \pause
    \item Rest can be user defined: \htycon{Bool}, \htycon{String}, \htycon{Maybe}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]{About Types}
  What does the data structure looks like?
  \pause
  \begin{itemize}
    \item Simple
    \pause
    \item Multiple \hvalcon{Value} constructors
    \pause
    \item Paremetrize over another type
    \pause
    \item Recursive
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Defining Data Types}
\begin{frame}[fragile]{Defining Data Types}
  Define new data type with \hkeyword{data}.

  \pause
  \ \\
  \begin{itemize}
    \item Left hand side (\htycon{LHS}) - \htycon{Type} constructor
    \item Right hand side (\hvalcon{RHS}) - \hvalcon{Value} constructor
  \end{itemize}

  \pause
  \ \\
  \htycon{Type} constructors and \hvalcon{Value} constructors are capticalized.
\end{frame}

\begin{frame}[fragile]{Our First Example!}
  Define a person:
  \begin{lstlisting}[style=hask]
    -- | params for firstname, lastname, age respectively
    data @tcPerson@ = @vcPerson@ String String Int
  \end{lstlisting}

  \pause
  A loose translation:
  \begin{lstlisting}[style=hask]
    enum @tcPerson@ {
      @vcPerson@(String firstname, String lastname, Int age)
    }
  \end{lstlisting}

  \pause
  In this example, the \htycon{Type} and \hvalcon{Value} constructor have the same name. The \htycon{Type} of the \hvalcon{Person} constructor:
  \begin{lstlisting}[style=hask]
    @vcPerson@ :: String -> String -> Int -> @tcPerson@

    bobby :: @tcPerson@
    bobby = @vcPerson@ "Bobby" "Smith" @vc23@
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Multiple Value Constructors}
  Data can have multiple \hvalcon{Value} constructors:
  \begin{lstlisting}[style=hask]
    data Bool = False | True

    data @tcWeekdays@ = @vcSunday@ | @vcMonday@ | @vcTuesday@ | @vcWednesday@
                  | @vcThursday@ | @vcFriday@ | @vcSaturday@
  \end{lstlisting}
  \textit{\tiny{Does this remind you of anything?}}

  \pause
  \ \\
  A loose translation:
  \begin{lstlisting}[style=hask]
    enum Bool { False, True }

    enum @tcWeekdays@ {
      @vcSunday@, @vcMonday@, @vcTuesday@, @vcWednesday@, @vcThursday@, @vcFriday@, @vcSaturday@
    }
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Multiple Value Constructor}
  You can do type aliasing with \hkeyword{type}:
  \begin{lstlisting}[style=hask]
    type @tcSide@ = Double
    type @tcRadius@ = Double
  \end{lstlisting}

  \pause
  For example:
  \begin{lstlisting}[style=hask]
    data @tcShape@ = @vcTriangle@ @tcSide@ @tcSide@ @tcSide@
               | @vcRectangle@ @tcSide@ @tcSide@
               | @vcCircle@ @tcRadius@
  \end{lstlisting}

  \pause
  A loose translation:
  \begin{lstlisting}[style=hask]
    enum @tcShape@ {
      @vcTriangle@(Double side1, Double side2, Double side3),
      @vcRectangle@(Double length, Double width),
      @vcCircle@(Double radius)
    }
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Multiple Value Constructor}
  Recall \htycon{Side} $\sim$ \htycon{Radius} $\sim$ \htycon{Double}:
  \begin{lstlisting}[style=hask]
    data @tcShape@ = @vcTriangle@ @tcSide@ @tcSide@ @tcSide@
               | @vcRectangle@ @tcSide@ @tcSide@
               | @vcCircle@ @tcRadius@
  \end{lstlisting}

  \pause
  \htycon{Types} of the \hvalcon{Value} constructors:
  \begin{lstlisting}[style=hask]
    @vcTriangle@  :: @tcSide@ -> @tcSide@ -> @tcSide@ -> @tcShape@
    @vcRectangle@ :: @tcSide@ -> @tcSide@ -> @tcShape@
    @vcCircle@    :: @tcRadius@ -> @tcShape@
  \end{lstlisting}

  \pause
  Example \htycon{Shapes}:
  \begin{lstlisting}[style=hask]
    myTri, myRect, myCir :: @tcShape@
    myTri  = @vcTriangle@ @vc2.1 3.2 5@
    myRect = @vcRectangle@ @vc4 4@
    myCir  = @vcCircle@ @vc7.2@
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Parametrization}
  Types can parametrize over another type:
  \begin{lstlisting}[style=hask]
    data @tcIdentity@ a = @vcIdentity@ a
  \end{lstlisting}

  \pause
  A loose translation:
  \begin{lstlisting}[style=hask]
    enum @tcIdentity@<T> {
      @vcIdentity@(T t)
    }
  \end{lstlisting}

  \pause
  The \htycon{Type} of the \hvalcon{Identity} constructor:
  \begin{lstlisting}[style=hask]
    @vcIdentity@ :: a -> @tcIdentity@ a

    intIdwrtSum :: @tcIndentity@ Int
    intIdwrtSum = @vcIdentity@ @vc0@
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Tuple}
  Parametrize over 2 types - 2-tuple!
  \begin{lstlisting}[style=hask]
    data @tcTuple@ a b = @vcTuple@ a b
    -- Actual built-in sugared version is something like:
    -- data (,) a b = (a, b)
  \end{lstlisting}

  \pause
  A loose translation:
  \begin{lstlisting}[style=hask]
    enum @tcTuple@<T1, T2> {
      @vcTuple@(T1 t1, T2 t2)
    }
  \end{lstlisting}

  \pause
  With:
  \begin{lstlisting}[style=hask]
    @vcTuple@ :: a -> b -> @tcTuple@ a b
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Tuple}
  Use the default sugared version:
  \begin{lstlisting}[style=hask]
    data (@tc,@) a b = (a@vc,@ b)
  \end{lstlisting}

  \pause
  An example:
  \begin{lstlisting}[style=hask]
    type @tcEmployed@ = Bool

    barbara, chet, luffy :: (@tcPerson@@tc,@ @tcEmployed@)
    barbara = (@vcPerson@ "Barbara" "Sakura" @vc30,@ True)
    chet    = (@vcPerson@ "Chet" "Awesome-Laser" @vc2,@ False)
    luffy   = (@vcPerson@ "Luff D." "Monkey" @vc19,@ False)
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Maybe}
  Like \htycon{Bool}, but parametrize an $a$ over the \htycon{True} part:
  \begin{lstlisting}[style=hask]
    data Maybe a = Nothing | Just a
  \end{lstlisting}

  \pause
  A loose translation:
  \begin{lstlisting}[style=hask]
    enum Maybe<T> {
      Nothing,
      Just(T t)
    }
  \end{lstlisting}

  \pause
  The \htycon{Types} of the two \hvalcon{Value} constructors:
  \begin{lstlisting}[style=hask]
    Nothing :: Maybe a
    Just    :: a -> Maybe a
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Maybe}
  From previous slide:
  \begin{lstlisting}[style=hask]
    data Maybe a = Nothing | Just a
  \end{lstlisting}

  \pause
  Say more with the occupation:
  \begin{lstlisting}[style=hask]
    type @tcOccupation@ = Maybe String

    barbara, chet, luffy :: (@tcPerson@@tc,@ @tcOccupation@)
    barbara = (@vcPerson@ "Barbara" "Sakura" @vc30,@ Just "dancer")
    chet    = (@vcPerson@ "Chet" "Awesome-Laser" @vc2,@ Nothing)
    luffy   = (@vcPerson@ "Luff D." "Monkey" @vc19,@ Just "pirate")
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Either}
  Like \htycon{Bool}, but parametrize over both \hvalcon{True} and \hvalcon{False}:
  \begin{lstlisting}[style=hask]
    data Either a b = Left a | Right b
  \end{lstlisting}

  \pause
  A loose translation:
  \begin{lstlisting}[style=hask]
    enum Either<T1, T2> {
      Left(T1 t1),
      Right(T2 t2)
    }
  \end{lstlisting}

  \pause
  The two \hvalcon{Value} constructors have \htycon{Types}:
  \begin{lstlisting}[style=hask]
    Left  :: a -> Either a b
    Right :: b -> Either a b
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Either}
  From previous slide:
  \begin{lstlisting}[style=hask]
    data Either a b = Left a | Right b
  \end{lstlisting}

  \pause
  Refine with more details:
  \begin{lstlisting}[style=hask]
    type @tcEarning@ = Either String Int

    barbara, chet, luffy :: (@tcPerson@@tc,@ @tcEarning@)
    barbara = (@vcPerson@ "Barbara" "Sakura" @vc30,@
              Right @vc100000@)
    chet    = (@vcPerson@ "Chet" "Awesome-Laser" @vc2,@
              Left "Is a baby") 
    luffy   = (@vcPerson@ "Luff D." "Monkey" @vc19,@
              Right @vc2000000@)
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Types with Recursion}
\end{frame}

\begin{frame}[fragile]{Phantom Types}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Functions}

\begin{frame}[fragile]{Functions}
\end{frame}

\begin{frame}[fragile]{Higher-order Functions}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Type Theory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{What is Dependent Type}

\begin{frame}[fragile]{Lambda Cube}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Dependent type programming in Haskell
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Steps toward Dependent Types}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Kinds}
\begin{frame}[fragile]{Kinds}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Language Extensions}

\begin{frame}[fragile]{GADTs}
\end{frame}

\begin{frame}[fragile]{KindSignatures}
\end{frame}

\begin{frame}[fragile]{ConstraintKinds}
\end{frame}

\begin{frame}[fragile]{Type Operators}
\end{frame}

\begin{frame}[fragile]{DataKinds}
\end{frame}

\begin{frame}[fragile]{Type Families}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Q & A
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Questions}

% q&a
\begin{frame}
  Questions?
\end{frame}


\end{document}

